{"version":3,"sources":["components/UI/Card.js","components/UI/LoadingIndicator.js","components/Ingredients/IngredientForm.js","components/Ingredients/Search.js","components/Ingredients/IngredientList.js","components/UI/ErrorModal.js","components/Ingredients/Ingredients.js","context/auth-context.js","components/Auth.js","App.js","index.js"],"names":["Card","props","react_default","a","createElement","className","children","LoadingIndicator","IngredientForm","React","memo","_useState","useState","_useState2","Object","slicedToArray","enteredTitle","setEnteredTitle","_useState3","_useState4","enteredAmount","setEnteredAmount","components_UI_Card","onSubmit","event","preventDefault","onAddIngredient","title","amount","htmlFor","type","id","value","onChange","target","loading","components_UI_LoadingIndicator","Search","onLoadIngredients","enteredFilter","setEnteredFilter","inputRef","useRef","useEffect","timer","setTimeout","current","query","length","concat","fetch","then","response","json","responseData","loadedIngredients","key","push","clearTimeout","ref","IngredientList","ingredients","map","ig","onClick","onRemoveItem","bind","ErrorModal","Fragment","onClose","Ingredients","userIngredients","setUserIngredients","isLoading","setIsLoading","_useState5","_useState6","error","setError","console","log","filteredIngredientsHandler","useCallback","filteredIngredients","UI_ErrorModal","Ingredients_IngredientForm","ingredient","method","body","JSON","stringify","headers","Content-Type","resoponseData","prevIngredients","toConsumableArray","objectSpread","name","Ingredients_Search","components_Ingredients_IngredientList","ingredientId","filter","catch","AuthContext","createContext","isAuth","login","AuthContextProvider","isAuthenticated","setIsAuthenticated","Provider","Auth","authContext","useContext","App","content","src_components_Auth","Ingredients_Ingredients","ReactDOM","createRoot","document","getElementById","render","auth_context","src_App"],"mappings":"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","file":"static/js/main.2e659c62.chunk.js","sourcesContent":["import React from 'react';\n\nimport './Card.css';\n\nconst Card = props => {\n  return <div className=\"card\">{props.children}</div>;\n};\n\nexport default Card;\n","import React from 'react';\n\nimport './LoadingIndicator.css';\n\nconst LoadingIndicator = () => (\n  <div className=\"lds-ring\">\n    <div />\n    <div />\n    <div />\n    <div />\n  </div>\n);\n\nexport default LoadingIndicator;\n","import React, { useState } from \"react\";\n\nimport Card from \"../UI/Card\";\nimport \"./IngredientForm.css\";\nimport LoadingIndicator from \"../UI/LoadingIndicator\";\n\nconst IngredientForm = React.memo((props) => {\n  const [enteredTitle, setEnteredTitle] = useState(\"\");\n  const [enteredAmount, setEnteredAmount] = useState(\"\");\n\n  const submitHandler = (event) => {\n    event.preventDefault();\n    // ...\n    props.onAddIngredient({ title: enteredTitle, amount: enteredAmount });\n  };\n\n  return (\n    <section className=\"ingredient-form\">\n      <Card>\n        <form onSubmit={submitHandler}>\n          <div className=\"form-control\">\n            <label htmlFor=\"title\">Name</label>\n            <input\n              type=\"text\"\n              id=\"title\"\n              value={enteredTitle}\n              onChange={(event) => {\n                setEnteredTitle(event.target.value);\n              }}\n            />\n          </div>\n          <div className=\"form-control\">\n            <label htmlFor=\"amount\">Amount</label>\n            <input\n              type=\"number\"\n              id=\"amount\"\n              value={enteredAmount}\n              onChange={(event) => {\n                setEnteredAmount(event.target.value);\n              }}\n            />\n          </div>\n          <div className=\"ingredient-form__actions\">\n            <button type=\"submit\">Add Ingredient</button>\n            {props.loading ? <LoadingIndicator /> : null}\n          </div>\n        </form>\n      </Card>\n    </section>\n  );\n});\n\nexport default IngredientForm;\n","import React, { useState, useEffect, useRef } from \"react\";\n\nimport Card from \"../UI/Card\";\nimport \"./Search.css\";\n\nconst Search = React.memo((props) => {\n  // 可以将props这个object中的 function, onLoadIngredients给卸下来\n  const { onLoadIngredients } = props;\n  const [enteredFilter, setEnteredFilter] = useState(\"\");\n\n  const inputRef = useRef();\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (enteredFilter === inputRef.current.value) {\n        const query =\n          enteredFilter.length === 0\n            ? \"\"\n            : `?orderBy=\"title\"&equalTo=\"${enteredFilter}\"`;\n        fetch(\n          \"https://react-hooks-update-48230-default-rtdb.firebaseio.com/ingredients.json\" +\n            query\n        )\n          .then((response) => response.json())\n          .then((responseData) => {\n            const loadedIngredients = [];\n            for (const key in responseData) {\n              loadedIngredients.push({\n                id: key,\n                title: responseData[key].title,\n                amount: responseData[key].amount,\n              });\n            }\n            onLoadIngredients(loadedIngredients);\n          });\n      }\n    }, 500);\n\n    // useEffect cleanup\n    return () => {\n      clearTimeout(timer);\n    };\n\n    // onLoadIngredients 如果在parent component 中，ie. Ingredients 中，用useCallback，那么这个地方\n    // 的值也理所当然的不会变，所以[enteredFilter, onLoadIngredients] 都没有改变，则useEffect只运行一次\n    // 所以就不会有infinite loop\n  }, [enteredFilter, onLoadIngredients, inputRef]);\n\n  return (\n    <section className=\"search\">\n      <Card>\n        <div className=\"search-input\">\n          <label>Filter by Title</label>\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={enteredFilter}\n            onChange={(event) => setEnteredFilter(event.target.value)}\n          />\n        </div>\n      </Card>\n    </section>\n  );\n});\n\nexport default Search;\n","import React from 'react';\n\nimport './IngredientList.css';\n\nconst IngredientList = props => {\n  return (\n    <section className=\"ingredient-list\">\n      <h2>Loaded Ingredients</h2>\n      <ul>\n        {props.ingredients.map(ig => (\n          <li key={ig.id} onClick={props.onRemoveItem.bind(this, ig.id)}>\n            <span>{ig.title}</span>\n            <span>{ig.amount}x</span>\n          </li>\n        ))}\n      </ul>\n    </section>\n  );\n};\n\nexport default IngredientList;\n","import React from 'react';\n\nimport './ErrorModal.css';\n\nconst ErrorModal = React.memo(props => {\n  return (\n    <React.Fragment>\n      <div className=\"backdrop\" onClick={props.onClose} />\n      <div className=\"error-modal\">\n        <h2>An Error Occurred!</h2>\n        <p>{props.children}</p>\n        <div className=\"error-modal__actions\">\n          <button type=\"button\" onClick={props.onClose}>\n            Okay\n          </button>\n        </div>\n      </div>\n    </React.Fragment>\n  );\n});\n\nexport default ErrorModal;\n","import React, { useEffect, useState, useCallback } from \"react\";\n\nimport IngredientForm from \"./IngredientForm\";\nimport Search from \"./Search\";\nimport IngredientList from \"./IngredientList\";\nimport ErrorModal from \"../UI/ErrorModal.js\";\n\nfunction Ingredients() {\n  const [userIngredients, setUserIngredients] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    console.log(\"RENDERING INGREDIENTS\", userIngredients);\n  }, [userIngredients]);\n\n  function addIngredientHandler(ingredient) {\n    setIsLoading(true);\n    fetch(\n      \"https://react-hooks-update-48230-default-rtdb.firebaseio.com/ingredients.json\",\n      {\n        method: \"POST\",\n        body: JSON.stringify(ingredient),\n        headers: { \"Content-Type\": \"application/json\" },\n      }\n    )\n      .then((response) => {\n        setIsLoading(false);\n        return response.json();\n      })\n      .then((resoponseData) => {\n        setUserIngredients((prevIngredients) => [\n          ...prevIngredients,\n          { id: resoponseData.name, ...ingredient },\n        ]);\n      });\n  }\n\n  function removeIngredientHandler(ingredientId) {\n    setIsLoading(true);\n    fetch(\n      `https://react-hooks-update-48230-default-rtdb.firebaseio.com/ingredients/${ingredientId}.json`,\n      {\n        method: \"DELETE\",\n      }\n    ).then((response) => {\n      setIsLoading(false);\n      setUserIngredients((prevIngredients) => {\n        return prevIngredients.filter(\n          (ingredient) => ingredient.id !== ingredientId\n        );\n      });\n    }).catch(error => {\n      setError(\"Something went wrong!\");\n      setIsLoading(false);\n    });\n  }\n\n  // 用了useCallback wrap起来之后，起到作用：当Ingredients componenet re-render的时候,\n  // useCallback 可以将内部函数catch起来，等到 re-render 全部结束之后，pass 到下面的child component 中\n  // 这样，onLoadIngredients={filteredIngredientsHandler} 就永远接受到同一个不会改变的参数\n  const filteredIngredientsHandler = useCallback((filteredIngredients) => {\n    setUserIngredients(filteredIngredients);\n  }, []);\n\n  function clearError() {\n    setError(null);\n  }\n\n  return (\n    <div className=\"App\">\n      {error ? <ErrorModal onClose={clearError}>{error}</ErrorModal> : null}\n      <IngredientForm\n        onAddIngredient={addIngredientHandler}\n        loading={isLoading}\n      />\n\n      <section>\n        <Search onLoadIngredients={filteredIngredientsHandler} />\n        <IngredientList\n          ingredients={userIngredients}\n          onRemoveItem={removeIngredientHandler}\n        ></IngredientList>\n      </section>\n    </div>\n  );\n}\n\nexport default Ingredients;\n","import React, { useState } from \"react\";\n\nexport const AuthContext = React.createContext({\n  isAuth: false,\n  login: () => {},\n});\n\nconst AuthContextProvider = (props) => {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n\n  const loginHandler = () => {\n    setIsAuthenticated(true);\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{ login: loginHandler, isAuth: isAuthenticated }}\n    >\n      {props.children}\n    </AuthContext.Provider>\n  );\n};\n\nexport default AuthContextProvider;\n","import React, { useContext } from 'react';\n\nimport Card from './UI/Card';\nimport './Auth.css';\nimport { AuthContext } from '../context/auth-context';\n\nconst Auth = props => {\n  \n  const authContext = useContext(AuthContext);\n  const loginHandler = () => {\n    return authContext.login();\n  };\n\n  return (\n    <div className=\"auth\">\n      <Card>\n        <h2>You are not authenticated!</h2>\n        <p>Please log in to continue.</p>\n        <button onClick={loginHandler}>Log In</button>\n      </Card>\n    </div>\n  );\n};\n\nexport default Auth;\n","import React, { useContext } from 'react';\n\nimport Ingredients from './components/Ingredients/Ingredients';\nimport Auth from './components/Auth';\nimport {AuthContext} from './context/auth-context';\n\nconst App = props => {\n  const authContext = useContext(AuthContext);\n\n  let content = <Auth />;\n  if (authContext.isAuth) {\n    content = <Ingredients />;\n  }\n\n  return content;\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\n\nimport \"./index.css\";\nimport App from \"./App\";\nimport AuthContextProvider from \"./context/auth-context\";\n\nconst root = ReactDOM.createRoot(document.getElementById(\"root\"));\nroot.render(\n  <AuthContextProvider>\n    <App />\n  </AuthContextProvider>\n);\n"],"sourceRoot":""}